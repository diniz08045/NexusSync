{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="h3 mb-0">Messages</h1>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newMessageModal">
                <i data-feather="plus" class="feather-sm me-1"></i> New Message
            </button>
        </div>
    </div>
</div>

<div class="row">
    <!-- Message list -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">Conversations</h5>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    <a href="{{ url_for('user.messages_static', conversation_id=1) }}" class="list-group-item list-group-item-action p-3 {% if conversation_id == '1' %}active{% endif %}">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px; min-width: 40px;">
                                <span class="text-white fw-bold">A</span>
                            </div>
                            <div>
                                <h6 class="mb-1">Admin User</h6>
                                <p class="mb-0 small text-secondary">Welcome to the CRM Suite!</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ url_for('user.messages_static', conversation_id=2) }}" class="list-group-item list-group-item-action p-3 {% if conversation_id == '2' %}active{% endif %}">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px; min-width: 40px;">
                                <span class="text-white fw-bold">J</span>
                            </div>
                            <div>
                                <h6 class="mb-1">John Smith</h6>
                                <p class="mb-0 small text-secondary">Let me know when you have time to discuss the new project.</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ url_for('user.messages_static', conversation_id=3) }}" class="list-group-item list-group-item-action p-3 {% if conversation_id == '3' %}active{% endif %}">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px; min-width: 40px;">
                                <span class="text-white fw-bold">S</span>
                            </div>
                            <div>
                                <h6 class="mb-1">Sarah Johnson</h6>
                                <p class="mb-0 small text-secondary">The meeting is scheduled for tomorrow at 2 PM.</p>
                            </div>
                        </div>
                    </a>
                    <a href="{{ url_for('user.messages_static', conversation_id=4) }}" class="list-group-item list-group-item-action p-3 {% if conversation_id == '4' %}active{% endif %}">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px; min-width: 40px;">
                                <span class="text-white fw-bold">S</span>
                            </div>
                            <div>
                                <h6 class="mb-1">Support Team</h6>
                                <p class="mb-0 small text-secondary">Your ticket has been resolved.</p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Message content -->
    <div class="col-md-8 mb-4">
        <div class="card h-100">
            {% if conversation_id %}
                {% set conversation_name = {
                    '1': 'Admin User',
                    '2': 'John Smith',
                    '3': 'Sarah Johnson',
                    '4': 'Support Team'
                }[conversation_id] %}
                
                <div class="card-header">
                    <h5 class="mb-0">{{ conversation_name }}</h5>
                </div>
                <div class="card-body">
                    <div class="mb-4" style="max-height: 400px; overflow-y: auto;">
                        <!-- First message -->
                        <div class="d-flex mb-3">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3 mt-1" style="width: 32px; height: 32px; min-width: 32px;">
                                <span class="text-white fw-bold small">{{ conversation_name[0] }}</span>
                            </div>
                            <div class="card p-3 rounded" style="max-width: 75%; background-color: rgba(var(--bs-secondary-rgb), 0.1);">
                                <div class="d-flex justify-content-between mb-1">
                                    <span class="small fw-bold">{{ conversation_name }}</span>
                                    <small class="text-muted">10:15 AM</small>
                                </div>
                                <p class="mb-0">Hi there!</p>
                            </div>
                        </div>
                        
                        <!-- Second message (from you) -->
                        <div class="d-flex mb-3 justify-content-end">
                            <div class="card p-3 rounded" style="max-width: 75%; background-color: rgba(var(--bs-primary-rgb), 0.1);">
                                <div class="d-flex justify-content-between mb-1">
                                    <span class="small fw-bold">You</span>
                                    <small class="text-muted">10:18 AM</small>
                                </div>
                                <p class="mb-0">Hello! How can I help you today?</p>
                            </div>
                            <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center ms-3 mt-1" style="width: 32px; height: 32px; min-width: 32px;">
                                <span class="text-white fw-bold small">Y</span>
                            </div>
                        </div>
                        
                        <!-- Third message -->
                        <div class="d-flex mb-3">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3 mt-1" style="width: 32px; height: 32px; min-width: 32px;">
                                <span class="text-white fw-bold small">{{ conversation_name[0] }}</span>
                            </div>
                            <div class="card p-3 rounded" style="max-width: 75%; background-color: rgba(var(--bs-secondary-rgb), 0.1);">
                                <div class="d-flex justify-content-between mb-1">
                                    <span class="small fw-bold">{{ conversation_name }}</span>
                                    <small class="text-muted">10:30 AM</small>
                                </div>
                                <p class="mb-0">
                                {% if conversation_id == '1' %}
                                Welcome to the CRM Suite!
                                {% elif conversation_id == '2' %}
                                Let me know when you have time to discuss the new project.
                                {% elif conversation_id == '3' %}
                                The meeting is scheduled for tomorrow at 2 PM.
                                {% elif conversation_id == '4' %}
                                Your ticket has been resolved.
                                {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Message input -->
                    <form class="d-flex">
                        <input type="text" class="form-control me-2" placeholder="Type your message here...">
                        <button type="submit" class="btn btn-primary">
                            <i data-feather="send" class="feather-sm"></i>
                        </button>
                    </form>
                </div>
            {% else %}
                <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                    <i data-feather="message-circle" class="feather-lg mb-3 text-secondary"></i>
                    <p class="text-secondary">Select a conversation from the list or start a new one.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- New Message Modal -->
<div class="modal fade" id="newMessageModal" tabindex="-1" aria-labelledby="newMessageModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="newMessageModalLabel">New Message</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="recipient" class="form-label">To:</label>
                        <select class="form-select" id="recipient" required>
                            <option value="" selected disabled>Select a recipient</option>
                            <option value="1">Admin User</option>
                            <option value="2">John Smith</option>
                            <option value="3">Sarah Johnson</option>
                            <option value="4">Support Team</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="subject" class="form-label">Subject:</label>
                        <input type="text" class="form-control" id="subject" required>
                    </div>
                    <div class="mb-3">
                        <label for="message-content" class="form-label">Message:</label>
                        <textarea class="form-control" id="message-content" rows="5" required></textarea>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}